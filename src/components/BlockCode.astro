---
import type { TypedObject, Props as TypeProps } from "astro-portabletext/types";
import "highlight.js/styles/xcode.css";
import hljs from "highlight.js";

type Props = TypeProps<
  TypedObject & {
    code: string;
    language: string;
  }
>;

const { node } = Astro.props as Props;

const highlightedCode = hljs.highlight(node.code, {
  language: node.language ?? "plaintext",
  ignoreIllegals: true,
}).value;
---

<div class=" bg-gray-100 dark:bg-gray-800 p-2 rounded-md relative">
  {
    node.code && (
        <p class="text-sm text-gray-500 absolute top-2 right-2">
          {node.language}
        </p>
      <pre class="text-sm"><code class="text-wrap wrap-anywhere" set:html={highlightedCode} /></pre>
    )
  }
</div>
